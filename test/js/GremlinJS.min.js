/*! GremlinJS - v0.4.0 - 2013-04-12 */(function(){var t={event:{}};t.event.Event=function(){function t(){this._events={}}return t.prototype.on=function(t,n){return this._events[t]=this._events[t]||[],this._events[t].push(n)},t.prototype.off=function(t,n){return!1!=t in this._events?this._events[t].splice(this._events[t].indexOf(n),1):void 0},t.prototype.emit=function(t){var n,e;if(this._events=this._events||{},!1!=t in this._events){for(n=0,e=[];this._events[t].length>n;)this._events[t][n].apply(this,Array.prototype.slice.call(arguments,1)),e.push(n++);return e}},t}(),t.conf={},t.conf.Configuration=function(){function t(){}var n,e;return n=null,e={autoload:!0},t=function(){function t(t){this._options=t}return t.prototype.set=function(t,n){return this._options[t]=n},t}(),t.options={AUTOLOAD:"autoload"},t.get=function(){return null!=n?n:n=new t(e)},t}(),t.util={},t.util.ready=function(){var t,n,e,r,i,o,s,u,l,a,c,f,m,p,h,d,_;if(p=function(t){var n;if(!a.body)return u(p);for(n=[];t=s.shift();)n.push(u(t));return n},e=function(){return d?(a.removeEventListener(n,e,r),p()):a[o]===t?(a.detachEvent(i,e),p()):void 0},u=function(t,n){return setTimeout(t,+n>=0?n:1)},m=function(t){return f?u(t):s.push(t)},_=window,a=_.document,c=a.documentElement,r=!1,t="complete",o="readyState",n="DOMContentLoaded",i="onreadystatechange",d="addEventListener"in a,f=h=r,s=[],a[o]===t)u(p);else if(d)a.addEventListener(n,e,r),_.addEventListener("load",p,r);else{a.attachEvent(i,e),_.attachEvent("onload",p);try{h=null==_.frameElement&&c}catch(y){}h&&h.doScroll&&(l=function(){if(!f){try{h.doScroll("left")}catch(t){return u(l,50)}return p()}})()}return m.version="1.2",m}(),t.util.polyfill={},"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),Array.prototype.filter||(Array.prototype.filter=function(t,n){var e,r,i,o,s;if(this===void 0||null===this)throw new TypeError;if(o=Object(this),r=o.length>>>0,"function"!=typeof t)throw new TypeError;for(i=[],e=0;r>e;)e in o&&(s=o[e],t.call(n,s,e,o)&&i.push(s)),e++;return i}),t.gremlinDefinitions={},t.gremlinDefinitions.AbstractGremlin=function(){function t(t,n,e){this.el=t,this.data=n,this.id=e}return t.prototype.initialize=function(){},t}();var n={}.hasOwnProperty;t.util.Helper=function(){function e(){}var r;return r=function(t,e){var r,i;for(r in e)n.call(e,r)&&(i=e[r],t[r]=i);return t},e.mixin=function(t,n){return r(t.prototype,n)},e.clone=function(n){var e,r;if(null==n||"object"!=typeof n)return n;if(n instanceof Date)return new Date(n.getTime());if(n instanceof RegExp)return e="",null!=n.global&&(e+="g"),null!=n.ignoreCase&&(e+="i"),null!=n.multiline&&(e+="m"),null!=n.sticky&&(e+="y"),RegExp(n.source,e);r=new n.constructor;for(e in n)r[e]=t.util.Helper.clone(n[e]);return r},e.hasClass=function(t,n){return t.className.match(RegExp("(\\s|^)"+n+"(\\s|$)"))},e.addClass=function(n,e){return t.util.Helper.hasClass(n,e)||(n.className+=" "+e),n.className=n.className.trim()},e.removeClass=function(n,e){var r;return t.util.Helper.hasClass(n,e)?(r=RegExp("(\\s|^)"+e+"(\\s|$)"),n.className=n.className.replace(r," "),n.className=n.className.trim()):void 0},e}();var n={}.hasOwnProperty,e=function(t,e){function r(){this.constructor=t}for(var i in e)n.call(e,i)&&(t[i]=e[i]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};t.gremlinDefinitions.Pool=function(){function n(){}var r,i;return i=null,r={},n=function(){function n(){}return n.prototype.get=function(t){var n;return null!=(n=r[t])?n:null},n.prototype.set=function(t,n){if(r[t]!==void 0)throw Error("Trying to add new Gremlin definition, but a definition for "+t+" already exists.");return r[t]=n},n.prototype.define=function(n,r){var i,o;return i=function(t){function n(){return o=n.__super__.constructor.apply(this,arguments)}return e(n,t),n}(t.gremlinDefinitions.AbstractGremlin),t.util.Helper.mixin(i,r),this.set(n,i)},n}(),n.getInstance=function(){return null!=i?i:i=new n},n}(),t.util.FeatureDetector=function(){function t(){}return t.hasQuerySelectorAll=document.querySelectorAll!==void 0,t.hasMutationObserver=!(!window.MutationObserver&&!window.WebKitMutationObserver&&!window.MozMutationObserver),t.hasGetClientRect=void 0!==document.body.getBoundingClientRect,t.hasCssAnimations=function(){var t,n,e,r;if(e=document.body,t=!1,n=["Webkit","Moz","O","ms","Khtml"],e.style.animationName&&(t=!0),!1===t)for(r=0;n.length>r;){if(void 0!==e.style[n[r]+"AnimationName"]){t=n[r],t.toLowerCase(),t=!0;break}r++}return t}(),t}(),t.gremlins={},t.gremlins.NameProvider=function(){function n(){}var e;return e=function(t,n){var e;return"function"==typeof t.hasAttribute?t.hasAttribute(n):(e=t.getAttributeNode(n),!(!e||!e.specified&&!e.nodeValue))},n.DATA_NAME_ATTR="data-gremlin-name",n.isGremlin=function(t){return e(t,"data-gremlin-name")},n.getNames=function(n){var e,r,i;r=n.getAttribute("data-gremlin-name");try{if(""===r)throw Error("No gremlin names available, 'data-gremlin-name' is empty!");var o,s,u,l;for(u=r.split(","),l=[],o=0,s=u.length;s>o;o++)e=u[o],l.push(e.trim());return l}catch(a){return e=null!=(i=n.outerHTML)?i:"",t.gremlins.NameProvider.flagBrokenElement(n),"undefined"!=typeof console&&null!==console&&"function"==typeof console.warn&&console.warn("Couldn't process gremlin element, "+a.message+"\n"+e),[]}},n.flagBrokenElement=function(n){return t.util.Helper.addClass(n,"gremlin-error"),t.gremlins.NameProvider.flagProcessedElement(n)},n.flagProcessedElement=function(t){return t.removeAttribute("data-gremlin-name")},n}(),t.domObserver={},t.domObserver.ElementList=function(){function n(t){this._attributeName=t}var e,r,i;return r=function(){function n(){}return n.get=function(n){var e,r,i,o;for(e=document.body.querySelectorAll("["+t.gremlins.NameProvider.DATA_NAME_ATTR+"]"),o=[],r=0,i=e.length;i>r;r++)n=e[r],o.push(n);return o},n}(),e=function(){function n(){}return n.get=function(n){var e,r,i,o;for(e=document.body.getElementsByTagName("*"),o=[],r=0,i=e.length;i>r;r++)n=e[r],t.gremlins.NameProvider.isGremlin(n)&&o.push(n);return o},n}(),i=t.util.FeatureDetector.hasQuerySelectorAll?r:e,n.prototype.getList=function(){return i.get(this._attributeName)},n}.call(this);var r=function(t,n){return function(){return t.apply(n,arguments)}};t.domObserver.clocks={},t.domObserver.clocks.MutationObserverClock=function(){function t(){if(this._onMutation=r(this._onMutation,this),null===n)throw Error("Mutation Observer not available")}var n;return n=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver||null,t.prototype.observe=function(){return new n(this._onMutation).observe(document.body,{childList:!0,subtree:!0})},t.prototype._onMutation=function(t){var n,e,r,i;for(i=[],e=0,r=t.length;r>e;e++){if(n=t[e],"childList"===n.type){this.onMutation();break}i.push(void 0)}return i},t.prototype.onMutation=function(){},t}(),r=function(t,n){return function(){return t.apply(n,arguments)}},t.domObserver.clocks.LegacyTimeoutClock=function(){function t(){this._onInterval=r(this._onInterval,this)}return t.prototype.observe=function(){return this._initiateInterval()},t.prototype._initiateInterval=function(){return this._interval=window.setTimeout(this._onInterval,500)},t.prototype._onInterval=function(){return this.onMutation(),this._initiateInterval()},t.prototype.onMutation=function(){},t}(),t.domObserver.clocks.cssAnimationStyle=function(n){return n="@keyframes {{ANIMATION_NAME}} {\n  0%   { opacity: 0.9; }\n  100% { opacity: 1; }\n}\n\n@-moz-keyframes {{ANIMATION_NAME}} {\n  0%   { opacity: 0.9; }\n  100% { opacity: 1; }\n}\n\n@-webkit-keyframes {{ANIMATION_NAME}} {\n  0%   { opacity: 0.9; }\n  100% { opacity: 1; }\n}\n\n@-o-keyframes {{ANIMATION_NAME}} {\n  0%   { opacity: 0.9; }\n  100% { opacity: 1; }\n}\n\n*[{{GREMLIN_ATTRIBUTE}}] {\n  animation-duration: 1ms;\n  -o-animation-duration: 1ms;\n  -moz-animation-duration: 1ms;\n  -webkit-animation-duration: 1ms;\n  animation-name: {{ANIMATION_NAME}};\n  -o-animation-name: {{ANIMATION_NAME}};\n  -moz-animation-name: {{ANIMATION_NAME}};\n  -webkit-animation-name: {{ANIMATION_NAME}};\n}".replace(/{{ANIMATION_NAME}}/g,n),n.replace(/{{GREMLIN_ATTRIBUTE}}/g,t.gremlins.NameProvider.DATA_NAME_ATTR)},r=function(t,n){return function(){return t.apply(n,arguments)}},t.domObserver.clocks.CssAnimationClock=function(){function n(){this._onAnimation=r(this._onAnimation,this);var n,i,o;i=document.getElementsByTagName("head")[0],o=document.createElement("style"),o.type="text/css",n=t.domObserver.clocks.cssAnimationStyle(e),o.styleSheet?o.styleSheet.cssText=n:o.appendChild(document.createTextNode(n)),i.appendChild(o)}var e,i;return e="gremlinInserted",i=["animationend","webkitAnimationEnd","oanimationend"],n.prototype.observe=function(){var t,n,e,r;for(r=[],n=0,e=i.length;e>n;n++)t=i[n],r.push(document.body.addEventListener(t,this._onAnimation,!1));return r},n.prototype._onAnimation=function(t){return t.animationName===e?this.onMutation():void 0},n.prototype.onMutation=function(){},n}(),t.domObserver.clocks.ClockFactory=function(){function n(){}var e,r;return e=t.util.FeatureDetector.hasCssAnimations,r=t.util.FeatureDetector.hasMutationObserver,n.createClock=function(){return new(e?t.domObserver.clocks.CssAnimationClock:r?t.domObserver.clocks.MutationObserverClock:t.domObserver.clocks.LegacyTimeoutClock)},n}(),r=function(t,n){return function(){return t.apply(n,arguments)}},n={}.hasOwnProperty,e=function(t,e){function r(){this.constructor=t}for(var i in e)n.call(e,i)&&(t[i]=e[i]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},t.MutationObserverShim=function(){function n(){}var i;return i=null,n=function(n){function i(){this._onMutation=r(this._onMutation,this),i.__super__.constructor.apply(this,arguments),this._clock=t.domObserver.clocks.ClockFactory.createClock(),this._clock.onMutation=this._onMutation}return e(i,n),i.RESCAN_INTERVAL=500,i.prototype._onMutation=function(){return this.emit(t.MutationObserverShim.ON_MUTATION)},i.prototype.observe=function(){return this._clock.observe(),this._onMutation()},i}(t.event.Event),n.ON_MUTATION="ON_MUTATION",n.get=function(){return null!=i?i:i=new n},n}.call(this),r=function(t,n){return function(){return t.apply(n,arguments)}},t.domObserver.DomObserver=function(){function n(){this._handleMutation=r(this._handleMutation,this),this._elementList=new t.domObserver.ElementList}return n.prototype._bindMutations=function(){var n;return n=t.MutationObserverShim.get(),n.on(t.MutationObserverShim.ON_MUTATION,this._handleMutation),n.observe()},n.prototype._handleMutation=function(){var t;return t=this._elementList.getList(),t.length>0?this.onNewElements(t):void 0},n.prototype.observe=function(){return this._bindMutations()},n.prototype.onNewElements=function(){},n}(),t.util.ElementData={},t.util.ElementData.DataValue=function(){function t(t){this._dataString=t}return t.prototype.parse=function(){var t,n;if(n=t=this._dataString,"string"==typeof this._dataString)try{n="true"===t?!0:"false"===t?!1:"null"===t?null:+t+""===t?+t:JSON.parse(t)}catch(e){}return n},t}(),n={}.hasOwnProperty,t.util.ElementData.ElementData=function(){function e(t){this._el=t,this._obj=i(this._el)}var r,i;return r=function(t){return t.toLowerCase().replace(/-(.)/g,function(t,n){return n.toUpperCase()})},i=function(e){var i,o,s,u;u={},void 0!==e.dataset?i=e.dataset:(i={},[].filter.call(e.attributes,function(t){var n;return(n=/^data-/.test(t.name))&&(i[r(t.name.substring(5))]=e.getAttribute(t.name)),n}));for(s in i)n.call(i,s)&&(o=i[s],o=new t.util.ElementData.DataValue(o),u[s]=o.parse());return u},e.prototype.get=function(t){var n;return null!=(n=this._obj[t])?n:null},e.prototype.toObject=function(){return t.util.Helper.clone(this._obj)},e}(),t.gremlinDefinitions.extensions={},t.gremlinDefinitions.extensions.Interests=function(){function t(){}var n,e;return n=function(){function t(){}var n;return n={},t.registerHandler=function(t,e,r){var i;return n[t]=null!=(i=n[t])?i:[],n[t].push({handler:e,ctx:r})},t.dispatch=function(t,e){var r,i,o,s,u;if(void 0!==n[t]){for(s=n[t],u=[],i=0,o=s.length;o>i;i++)r=s[i],u.push(r.handler.call(r.ctx,e));return u}},t}(),e=function(){var t,e,r,i;this.interests=null!=(t=this.interests)?t:{},this.emit=function(t,e){return n.dispatch(t,e)},r=this.interests,i=[];for(e in r)t=r[e],i.push(n.registerHandler(e,this[t],this));return i},t.test=function(){return!0},t.bind=function(t){return e.call(t)},t}.call(this),n={}.hasOwnProperty,t.gremlinDefinitions.extensions.DomElements=function(){function e(){}var r,i;return i=t.util.FeatureDetector.hasQuerySelectorAll,r=function(){var t,e,r,i;if("object"==typeof this.elements){r=this.elements,i=[];for(e in r)if(n.call(r,e)){if(t=r[e],this[t]!==void 0)throw new TypeError("Element member "+t+" already defined!");if("string"!=typeof e)throw new TypeError("Element selector have to be referenced by strings!");i.push(this[t]=this.el.querySelectorAll(e))}return i}},e.test=function(){return i},e.bind=function(t){return r.call(t)},e}(),n={}.hasOwnProperty,t.gremlinDefinitions.extensions.JQuery=function(){function t(){}var e,r,i;return i="function"==typeof window.jQuery||"function"==typeof window.Zepto,e=function(){var t,e,r,i;if("object"==typeof this.elements){r=this.elements,i=[];for(e in r)if(n.call(r,e)){if(t=r[e],"string"!=typeof e)throw new TypeError("Element selector have to be referenced by strings!");i.push(this["$"+t]=this.$el.find(e))}return i}},r=function(){var t,e,r,i,o=this;if("object"==typeof this.events){i=this.events,r=function(t,n){var e,r,i,s;if("string"!=typeof n)throw new TypeError("Event selectors have to be referenced by strings!");if("function"!=typeof o[t])throw new TypeError("Event '"+n+"' can't be bound to '"+o.name+"."+t+"', as the type is "+typeof o[t]);return i=o[t],r=n.indexOf(" "),e=(s=-1!==r)?n.substr(0,r):n,r=s?n.substr(r+1):null,o.$el.on(e,r,function(){return i.apply(o,arguments),!0})};for(t in i)n.call(i,t)&&(e=i[t],r(e,t));return!0}},t.test=function(){return i},t.bind=function(t){return t.$el=$(t.el),e.call(t),r.call(t)},t}(),n={}.hasOwnProperty,t.gremlins.GremlinFactory=function(){function e(){}var r,i;return i=function(){var t;return t=0,function(){return t++}}(),r=function(e){var r,i,o,s;o=t.gremlinDefinitions.extensions,s=[];for(i in o)n.call(o,i)&&(r=o[i],r.test()&&s.push(r.bind(e)));return s},e.getInstance=function(n,e,o){return n=t.gremlinDefinitions.Pool.getInstance().get(n),"function"==typeof n?(e=new n(e,o.toObject(),i()),r(e),e):null},e}();var i;i=t.util.FeatureDetector.hasGetClientRect,t.gremlins.GremlinDomElement=function(){function n(n,i){this._el=n,this._name=i,this._data=new t.util.ElementData.ElementData(this._el),this._isLazy=!0===this._data.get(r)?!0:!1,t.util.Helper.addClass(this._el,e)}var e,r;return r="gremlinLazy",e="gremlin-loading",n.DATA_GREMLIN_NAME_ATTRIBUTE="data-gremlin-name",n.GREMLIN_LOADING_CLASS="gremlin-loading",n.GREMLIN_READY_CLASS="gremlin-ready",n.GREMLIN_LAZY_BUFFER=100,n.prototype._gremlinInstance=null,n.prototype.check=function(){return this._isInViewport()?this._create():void 0},n.prototype._isInViewport=function(){var t;return this._isLazy&&i?(t=document.documentElement.clientHeight,this._el.getBoundingClientRect().top-t<n.GREMLIN_LAZY_BUFFER):!0},n.prototype._create=function(){return this._gremlinInstance=t.gremlins.GremlinFactory.getInstance(this._name,this._el,this._data),this.hasGremlin()?(this._gremlinInstance.initialize(),t.util.Helper.removeClass(this._el,e),t.util.Helper.addClass(this._el,"gremlin-ready")):void 0},n.prototype.hasGremlin=function(){return null!==this._gremlinInstance},n.prototype._loadGremlin=function(t){if(helper.removeClass(this._el,this._cls),helper.addClass(this._el,n.GREMLIN_LOADING_CLASS),t=t.trim(),helper.isString(t)&&!helper.isEmptyString(t))return this._createGremlin(t);throw Error("Can't create a gremlin without a classname defined for it.")},n.prototype._createGremlin=function(t){var e=this;return Factory.getInstance(t,this._el,this._data.toObject(),function(t){return e._gremlins.push(t),helper.removeClass(e._el,n.GREMLIN_LOADING_CLASS),helper.addClass(e._el,n.GREMLIN_READY_CLASS),!0})},n.prototype.load=function(){var t,e,r,i,o;if(null===this._gremlins){for(this._gremlins=[],t=this._el.getAttribute(n.DATA_GREMLIN_NAME_ATTRIBUTE),i=t.split(n.GREMLIN_NAME_SEPARATOR),o=[],e=0,r=i.length;r>e;e++)t=i[e],o.push(this._loadGremlin(t));return o}},n}(),r=function(t,n){return function(){return t.apply(n,arguments)}},t.gremlins.GremlinCollection=function(){function n(){this._scrollHandler=r(this._scrollHandler,this),this._queue=[],this._elements=[],this._lazyElements=[]}return n.prototype._elements=null,n.prototype._queue=null,n.prototype._lazyElements=null,n.prototype._bindScroll=function(){return window.addEventListener?window.addEventListener("scroll",this._scrollHandler,!1):window.attachEvent?window.attachEvent("onscroll",this._scrollHandler):void 0},n.prototype.add=function(t){var n,e,r;for(e=0,r=t.length;r>e;e++)n=t[e],this._addGremlinElements(n);return this._processQueue()},n.prototype._addGremlinElements=function(n){var e,r,i,o,s;for(r=t.gremlins.NameProvider.getNames(n),t.gremlins.NameProvider.flagProcessedElement(n),s=[],i=0,o=r.length;o>i;i++)e=r[i],s.push(this._queue.push(new t.gremlins.GremlinDomElement(n,e)));return s},n.prototype._processQueue=function(){var t,n,e,r,i;for(n=[],i=this._queue,e=0,r=i.length;r>e;e++)t=i[e],t.check(),t.hasGremlin()||n.push(t);return this._queue=n},n.prototype._processElement=function(t){return this._elements.push(new GremlinDomElement(t,this._cssClass)),t=this._elements[this._elements.length-1],t.isLazy()?this._lazyElements.push(t):t.load()},n.prototype._scrollHandler=function(){var t,n,e,r,i;if(this._lazyElements.length>0){for(n=[],i=this._lazyElements,e=0,r=i.length;r>e;e++)t=i[e],this._checkLazyElement(t,n);return this._lazyElements=n}},n.prototype._checkElement=function(t,n){return t.isInViewport()?t.load():n.push(t)},n}(),r=function(t,n){return function(){return t.apply(n,arguments)}},t.Application=function(){function n(){}var e;return e=null,n=function(){function n(){this._onNew=r(this._onNew,this),this._conf=t.conf.Configuration.get(),this._observer=new t.domObserver.DomObserver,this._observer.onNewElements=this._onNew,this._coll=new t.gremlins.GremlinCollection}return n.prototype._observer=null,n.prototype._coll=null,n.prototype._onNew=function(t){return this._coll.add(t)},n.prototype.start=function(){return this._observer.observe()},n.prototype.config=function(t,n){this._conf.set(t,n)},n}(),n.get=function(){return null!=e?e:e=new n},n}.call(this);var o;o=function(){function n(){}return t.util.ready(function(){return t.Application.get().start()}),n.options=t.conf.Configuration.options,n.config=function(n,e){return t.Application.get().config(n,e)},n.define=function(n,e){return t.gremlinDefinitions.Pool.getInstance().define(n,e)},n}(),window.GremlinJS=o,"function"==typeof window.define&&window.define.amd&&define("GremlinJS",[],function(){return o})})();